<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>AI Resume Matcher</title>
    <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/pdf.js/3.11.174/pdf.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/mammoth/1.6.0/mammoth.browser.min.js"></script>
    <style>
        body { font-family: sans-serif; padding: 20px; background: #f4f7f6; }
        .container { max-width: 800px; margin: auto; background: white; padding: 2rem; border-radius: 10px; box-shadow: 0 4px 6px rgba(0,0,0,0.1); }
        textarea { width: 100%; height: 150px; margin: 10px 0; border-radius: 5px; border: 1px solid #ddd; padding: 10px; }
        .btn { background: #0070f3; color: white; border: none; padding: 10px 20px; border-radius: 5px; cursor: pointer; width: 100%; font-size: 16px; }
        .card { border: 1px solid #eee; padding: 15px; margin-top: 15px; border-radius: 8px; }
        .tag { display: inline-block; background: #e0f2fe; color: #0369a1; padding: 2px 8px; border-radius: 12px; font-size: 12px; margin: 2px; }
    </style>
</head>
<body>
    <div id="root"></div>
    <script type="text/babel">
        const { useState } = React;
        function App() {
            const [jd, setJd] = useState('');
            const [resumes, setResumes] = useState([]);
            const [results, setResults] = useState(null);
            const [loading, setLoading] = useState(false);

            const handleFile = async (e) => {
                const files = Array.from(e.target.files);
                const data = await Promise.all(files.map(async f => {
                    const text = f.type === "application/pdf" ? "PDF Content" : "Doc Content"; // Simple placeholder for brevity
                    return { name: f.name, content: text };
                }));
                setResumes(data);
            };

            const analyze = async () => {
                setLoading(true);
                try {
                    const res = await fetch('/api/analyze', {
                        method: 'POST',
                        headers: { 'Content-Type': 'application/json' },
                        body: JSON.stringify({ resumes, jobDescription: jd })
                    });
                    const data = await res.json();
                    setResults(data);
                } catch (e) { alert("Error connecting to API"); }
                setLoading(false);
            };

            return (
                <div className="container">
                    <h1>ðŸŽ¯ AI Resume Matcher</h1>
                    <textarea placeholder="Paste Job Description..." onChange={e => setJd(e.target.value)} />
                    <input type="file" multiple onChange={handleFile} />
                    <button className="btn" onClick={analyze} disabled={loading}>{loading ? "Analyzing..." : "Find Best Match"}</button>
                    {results && results.detailed_analysis.map((r, i) => (
                        <div key={i} className="card">
                            <h3>{r.resume_name} - {r.score}% Match</h3>
                            <p><strong>Tech Match:</strong> {r.matching_technologies.map(t => <span className="tag">{t}</span>)}</p>
                            <p><strong>Missing:</strong> {r.missing_keywords.join(', ')}</p>
                        </div>
                    ))}
                </div>
            );
        }
        ReactDOM.createRoot(document.getElementById('root')).render(<App />);
    </script>
</body>
</html>
